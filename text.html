<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Pizzaria Maluca</title>

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
  <style>
    body { background-color: #fffaf8; font-family: Arial, sans-serif; }
    .bg-top { background: #5b256a; height: 100px; }
    .width-fix { max-width: 500px; margin: auto; }
    .card { border-radius: 15px; border: none; box-shadow: 0 3px 6px rgba(0,0,0,0.1); }
    .hidden { display: none !important; }
    .btn-yellow { background: #ffc107; color: #000; border-radius: 50px; font-weight: bold; }
    .btn-full { width: 90%; display: block; margin: 20px auto; text-align: center; padding: 10px; }
    .container-voltar i { font-size: 1.4rem; color: #5b256a; }
    .modal-actions .container-modal-actions a { display:block; padding:10px; border-bottom:1px solid #eee; color:#333; text-decoration:none; }
    .color-red { color: red !important; }
    .card-address, .card-opcionais { border-left: 5px solid #5b256a; }
  </style>
</head>

<body>

  <div class="bg-top"></div>

  <header class="width-fix mt-3">
    <div class="card p-3 d-flex flex-row align-items-center">
      <a href="#!" class="container-voltar me-3"><i class="fas fa-arrow-left"></i></a>
      <h1 class="h5 text-center flex-grow-1 mb-0"><b>Seu carrinho</b></h1>
    </div>
  </header>

  <!-- Carrinho vazio -->
  <section class="carrinho width-fix mt-4" id="carrinho-vazio">
    <div class="card card-address p-3 text-center">
      <i class="fas fa-cart-plus fa-3x mb-3 text-secondary"></i>
      <p><b>Seu carrinho está vazio</b></p>
      <small>Volte ao cardápio, selecione os itens e adicione ao seu carrinho.</small>
    </div>
  </section>

  <!-- Carrinho cheio -->
  <section class="carrinho width-fix mt-4 hidden" id="carrinho-cheio">
    <div id="listaProdutos"></div>

    <div class="card p-3 mt-3">
      <div class="d-flex justify-content-between">
        <b>Total</b>
        <b id="lblTotalCarrinho">R$ 0,00</b>
      </div>
    </div>
  </section>

  <!-- Opções e dados -->
  <section class="opcionais width-fix mt-4 pb-5 hidden" id="opcoes-entrega">
    <div class="card p-3 mb-3">
      <b>Como deseja receber?</b>
      <div class="form-check mt-2">
        <input class="form-check-input" type="checkbox" id="chkEntrega" onchange="carrinho.method.changeTipoEntrega()">
        <label class="form-check-label" for="chkEntrega">Entrega</label>
      </div>
      <div class="form-check">
        <input class="form-check-input" type="checkbox" id="chkRetirada" onchange="carrinho.method.changeTipoRetirada()">
        <label class="form-check-label" for="chkRetirada">Retirada</label>
      </div>
    </div>

    <div class="card p-3 mb-3 hidden" id="containerEnderecoEntrega">
      <b>Endereço:</b>
      <p id="lblEnderecoSelecionado">Nenhum endereço selecionado</p>
      <button class="btn btn-yellow btn-sm" onclick="carrinho.method.abrirModalEndereco()">Adicionar Endereço</button>
    </div>

    <div class="card p-3 mb-3">
      <b>Nome:</b>
      <input id="txtNomeSobrenome" type="text" class="form-control mt-2" placeholder="Seu nome completo">
    </div>

    <div class="card p-3 mb-3">
      <b>Celular:</b>
      <input id="txtCelular" type="text" class="form-control mt-2" placeholder="(00) 00000-0000">
    </div>

    <div class="card p-3 mb-3">
      <b>Forma de pagamento:</b>
      <button class="btn btn-yellow btn-sm mt-2" onclick="carrinho.method.abrirModalFormaPagamento()">Selecionar</button>
      <p class="mt-2 mb-0" id="lblFormaPagamentoSelecionada"></p>
    </div>
  </section>

  <a class="btn btn-yellow btn-full hidden" id="btnFazerPedido" onclick="carrinho.method.fazerPedido()">
    Fazer pedido <span id="lblTotalCarrinhoBotao"></span>
  </a>

  <a href="#" class="btn btn-yellow btn-full voltar hidden" id="btnVoltar">
    Voltar para o cardápio
  </a>

  <!-- Modal Endereço -->
  <div class="modal fade" id="modalEndereco" tabindex="-1">
    <div class="modal-dialog"><div class="modal-content p-3">
      <h5><b>Endereço</b></h5>
      <input id="txtEndereco" class="form-control mt-2" placeholder="Rua, número, bairro">
      <input id="txtCidade" class="form-control mt-2" placeholder="Cidade">
      <input id="txtUf" class="form-control mt-2" placeholder="UF">
      <button class="btn btn-yellow btn-sm mt-3" onclick="carrinho.method.salvarEndereco()">Salvar</button>
    </div></div>
  </div>

  <!-- Modal Forma de Pagamento -->
  <div class="modal-actions hidden" id="modalActionsFormaPagamento">
    <div class="backdrop" onclick="carrinho.method.fecharModalActionsFormaPagamento()"></div>
    <div class="width-fix container-modal-actions bg-white p-3">
      <a href="#!" onclick="carrinho.method.selecionarFormaPagamento('Pix')">Pix</a>
      <a href="#!" onclick="carrinho.method.selecionarFormaPagamento('Dinheiro')">Dinheiro</a>
      <a href="#!" onclick="carrinho.method.selecionarFormaPagamento('Cartão')">Cartão</a>
      <a href="#!" class="color-red" onclick="carrinho.method.selecionarFormaPagamento('')">Remover</a>
    </div>
  </div>

  <!-- JS -->
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

  <script>
  // ===============================
  // SIMULAÇÃO DE CARRINHO FICTÍCIO
  // ===============================
  document.addEventListener("DOMContentLoaded", () => {
    carrinho.event.init();
  });

  const carrinho = {
    event: {
      init() {
        // cria dados fictícios
        const dadosFake = {
          itens: [
            { guid: '1', nome: 'Pizza Calabresa', quantidade: 1, valor: 35.90, opcionais: [], observacao: 'Extra queijo' },
            { guid: '2', nome: 'Refrigerante Lata', quantidade: 2, valor: 6.00, opcionais: [], observacao: '' }
          ]
        };
        localStorage.setItem('cart', JSON.stringify(dadosFake));
        carrinho.method.obterCarrinho();
      }
    },
    method: {
      obterCarrinho() {
        const cart = JSON.parse(localStorage.getItem('cart') || '{}');
        if (cart.itens && cart.itens.length > 0) {
          document.querySelector('#carrinho-vazio').classList.add('hidden');
          document.querySelector('#carrinho-cheio').classList.remove('hidden');
          document.querySelector('#opcoes-entrega').classList.remove('hidden');
          document.querySelector('#btnFazerPedido').classList.remove('hidden');
          carrinho.method.carregarProdutosCarrinho(cart.itens);
        }
      },
      carregarProdutosCarrinho(list) {
        const lista = document.getElementById('listaProdutos');
        lista.innerHTML = '';
        let total = 0;
        list.forEach(e => {
          const preco = (e.quantidade * e.valor).toFixed(2).replace('.', ',');
          total += e.quantidade * e.valor;
          lista.innerHTML += `
            <div class="card p-3 mb-2">
              <div class="d-flex justify-content-between">
                <div>
                  <b>${e.quantidade}x ${e.nome}</b><br>
                  <small>${e.observacao || ''}</small>
                </div>
                <div><b>R$ ${preco}</b></div>
              </div>
              <button class="btn btn-sm btn-outline-danger mt-2" onclick="carrinho.method.removerProdutoCarrinho('${e.guid}')">
                <i class="fas fa-trash"></i> Remover
              </button>
            </div>`;
        });
        document.getElementById('lblTotalCarrinho').innerText = `R$ ${total.toFixed(2).replace('.', ',')}`;
        document.getElementById('lblTotalCarrinhoBotao').innerText = `R$ ${total.toFixed(2).replace('.', ',')}`;
      },
      removerProdutoCarrinho(guid) {
        let cart = JSON.parse(localStorage.getItem('cart'));
        cart.itens = cart.itens.filter(i => i.guid !== guid);
        localStorage.setItem('cart', JSON.stringify(cart));
        carrinho.method.obterCarrinho();
      },
      changeTipoEntrega() {
        document.getElementById('chkRetirada').checked = false;
        document.getElementById('containerEnderecoEntrega').classList.remove('hidden');
      },
      changeTipoRetirada() {
        document.getElementById('chkEntrega').checked = false;
        document.getElementById('containerEnderecoEntrega').classList.add('hidden');
      },
      abrirModalEndereco() {
        new bootstrap.Modal(document.getElementById('modalEndereco')).show();
      },
      salvarEndereco() {
        const endereco = document.getElementById('txtEndereco').value;
        const cidade = document.getElementById('txtCidade').value;
        const uf = document.getElementById('txtUf').value;
        document.getElementById('lblEnderecoSelecionado').innerText = `${endereco}, ${cidade} - ${uf}`;
        bootstrap.Modal.getInstance(document.getElementById('modalEndereco')).hide();
      },
      abrirModalFormaPagamento() {
        document.getElementById('modalActionsFormaPagamento').classList.remove('hidden');
      },
      fecharModalActionsFormaPagamento() {
        document.getElementById('modalActionsFormaPagamento').classList.add('hidden');
      },
      selecionarFormaPagamento(forma) {
        const lbl = document.getElementById('lblFormaPagamentoSelecionada');
        lbl.innerText = forma ? `Forma: ${forma}` : '';
        carrinho.method.fecharModalActionsFormaPagamento();
      },
      fazerPedido() {
        alert('Pedido fictício realizado com sucesso!');
        localStorage.removeItem('cart');
        window.location.reload();
      }
    }
  };
  </script>

</body>
</html>
